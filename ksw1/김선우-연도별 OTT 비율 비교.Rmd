---
title: "연도별 OTT 시청인구의 비율 비교"
author: "김선우"
date: "`r Sys.Date()`"
output: html_document
---

# 주제 : 연도별 OTT 시청인구 비율의 비교

## 0. 출처 
  - https://stat.kisdi.re.kr/kor/tblInfo/TblInfoList2.html?vw_cd=MT_ETITLE&siteGb=SITE001
  - 미디어통계포털 / KISDISTAT - 최근 3개월 OTT서비스 이용 경험여부


## 1. 데이터 파일 불러오기
```{r}
mydata <- read.csv('C:/Kimsunwoo/teamprojectdata/ksw/ott.csv', header=T)
View(mydata)
```

## 2. 패키지 준비
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(readxl)
```

## 3. 전처리

### (1) 컬럼 이름 변경
```{r}
mydata[mydata$구분별.2.=='남',]
mydata[mydata$구분별.2.=='여',]

mydata1 <- mydata
names(mydata1)

mydata1<-rename(mydata1, cat1=구분별.1., cat2=구분별.2., 총인구.2019=X2019, 시청경험_있음.2019=X2019.1, 시청경험_없음.2019=X2019.2, 총인구.2020=X2020, 시청경험_있음.2020=X2020.1, 시첨경험_없음.2020=X2020.2, 총인구.2021=X2021, 시청경험_있음.2021=X2021.1, 시청경험_없음.2021=X2021.2)
mydata1 <- mydata1[-1,]

summary(mydata1)
```

### (2) 변수명 처리
```{r}
str(mydata1)

sex <- subset(mydata1, cat1 == '성별')
sex
age <- subset(mydata1, cat1 == '연령')
income <- subset(mydata1, cat1 == '월평균소득')
school <- subset(mydata1, cat1 == '학력1')
region <- subset(mydata1, cat1 == '지역')
region.1 <- subset(mydata1, cat1 == '지역구분2')
job.wide <- subset(mydata1, cat1 == '종사상지위')
job.narrow <- subset(mydata1, cat1 == '상세직업')
house <- subset(mydata1, cat1 == '주택형태')
family.1 <- subset(mydata1, cat1 == '가족구성')
family.2 <- subset(mydata1, cat1 == '가구원수')
family.3 <- subset(mydata1, cat1 == '가구주와의관계')
```

## 4. EDA

### (1) 남자와 여자 년도별 OTT시청 비율 증가량 비교

#### 1) Preprocessing

```{r}
man <- subset(mydata1, cat2 == '남')
woman <- subset(mydata1, cat2 == '여')

man1 <- man %>% select(시청경험_있음.2019, 시청경험_있음.2020, 시청경험_있음.2021)
man1
woman1 <- woman %>% select(시청경험_있음.2019, 시청경험_있음.2020, 시청경험_있음.2021)
woman1

long.man <- man1 %>% gather(key = years, value = pop)
long.man

long.woman <- woman1 %>% gather(key = years, value = pop)
long.woman

long.man$pop
long.woman$pop
```


#### 2) 시각화
```{r}
par(mfrow=c(1,2))
plot(long.man$pop, type='o',xlab = 'man', ylab='percent',xlim=c(1,3), ylim=c(0,100),xaxt = "n", col='blue')
axis(1, at=1:3, labels = c('2019', '2020', '2021'))

plot(long.woman$pop, type='o',xlab = 'woman',ylab='percent',xlim=c(1,3), ylim=c(0,100),xaxt = "n",col='red')
axis(1, at=1:3, labels = c('2019', '2020', '2021'))
```

#### 3) 결론
  - 코로나가 시작된 2019년 이후로 남녀 모두 OTT시청 비율이 급격히 늘었다.
  
  
### (2) 나이대에 따라 연도별 OTT시청 비율 증가량 비교 및 주 시청자의 나이대 추론

#### 1) Preprocessing
```{r}
age
age1 <- age %>% select(cat2, 시청경험_있음.2019, 시청경험_있음.2020, 시청경험_있음.2021)
View(age1)

age10d <- subset(age1, cat2 == '만10대미만')
age10to19 <- subset(age1, cat2 == '만10-19세')
age20to29 <- subset(age1, cat2 == '만20-29세')
age30to39 <- subset(age1, cat2 == '만30-39세')
age40to49 <- subset(age1, cat2 == '만40-49세')
age50to59 <- subset(age1, cat2 == '만50-59세')
age60to69 <- subset(age1, cat2 == '만60-69세')
age70u <- subset(age1, cat2 == '만70세이상')

```


```{r}
long.age10d <- age10d %>% gather(key = years, value = pop)
long.age10d <-long.age10d[-1,]
long.age10to19 <- age10to19 %>% gather(key = years, value = pop)
long.age10to19 <- long.age10to19[-1,]
long.age20to29 <- age20to29 %>% gather(key = years, value = pop)
long.age20to29 <- long.age20to29[-1,]
long.age30to39 <- age30to39 %>% gather(key = years, value = pop)
long.age30to39 <- long.age30to39[-1,]
long.age40to49 <- age40to49 %>% gather(key = years, value = pop)
long.age40to49 <- long.age40to49[-1,]
long.age50to59 <- age50to59 %>% gather(key = years, value = pop)
long.age50to59 <- long.age50to59[-1,]
long.age60to69 <- age60to69 %>% gather(key = years, value = pop)
long.age60to69 <- long.age60to69[-1,]
long.age70u <- age70u %>% gather(key = years, value = pop)
long.age70u <- long.age70u[-1,]

```

#### 2) 시각화
```{r}
par(mfrow=c(1,1))
plot(long.age10d$pop,type='o',xlim=c(1,4), ylim=c(0,100),xaxt = "n",xlab = 'year', ylab='percent',col=1)
axis(1, at=1:3, labels = c('2019', '2020', '2021'))
lines(long.age10to19$pop,type='o',col=2)
lines(long.age20to29$pop,type='o',col=3)
lines(long.age30to39$pop,type='o',col=4)
lines(long.age40to49$pop,type='o',col=5)
lines(long.age50to59$pop,type='o',col=6)
lines(long.age60to69$pop,type='o',col=7)
lines(long.age70u$pop,type='o',col=8)


legend("topright", c("만10대 미만", "만10세-19세", "만20세-29세", "만30-39세", "만40-49세", "만50-59세", "만60-69세", "만70세 이상"), 
       col = c(1,2,3,4,5,6,7,8),lty=1)

```

#### 3) 결론
 - 만 10세에서 39세까지는 대부분의 사람들이 OTT서비스를 이용하고 있고 나이가 많아질수록 증가는 하는 경향은 있으나 비율은 다른 나이대에 비해 높지 않다.
 - 이를 통해 OTT 서비스의 주 이용고객층은 만 10세에서 39세까지의 청소년, 청년, 중년층임을 알 수 있다.
